<plex-layout>
    <plex-layout-main>
        <header justify responsive>
            <div class="marca">
                <div svgLogo></div>
                <div svgAcronimo></div>
                <div class="provincia">
                    <div>
                        {{ provincia }}
                    </div>
                </div>
            </div>
            <div class="bienvenida">
                <div class="efector">
                    {{ auth.organizacion.nombre }}
                </div>
                <div class="hola">
                    Hola <b>{{ auth.usuario.nombre }}</b>
                </div>
                <div *ngIf="!denied" class="mensaje">
                    ¿En qué vas a trabajar hoy?
                </div>
                <div *ngIf="denied" class="mensaje">
                    ¡Bienvenida/o a ANDES!
                </div>
            </div>

        </header>
        <hr>
        <main *ngIf="!denied && !loading" responsive>
            <plex-loader *ngIf="loading" type="linear"></plex-loader>
            <div class="modulos">
                <ng-container *ngFor="let modulo of modulos">

                    <div *ngIf="modulo.activo" class="modulo">
                        <div class="principal" [style.color]="modulo.color">
                            <b class="titulo">{{ modulo.nombre }}
                                <a href="javascript:void();" *ngIf="novedades[modulo._id]?.length > 0" hintType="info"
                                   hint="Novedades del módulo {{ modulo.nombre }}" detach="both" hintIcon="bell"
                                   (click)="irANovedades(modulo._id)"></a>
                            </b>
                            <div class="descripcion">{{ modulo.descripcion }}</div>
                        </div>
                        <div class="submodulos d-flex align-items-start">
                            <ng-container *ngFor="let submodulo of modulo.submodulos">
                                <a href="javascript:void();" *ngIf="submodulo.activo"
                                   class="submodulo {{submodulo.class}} hover" [style.background]="submodulo.color"
                                   (click)="redirect(submodulo)">
                                    <plex-icon [name]="submodulo.icono" size="lg"></plex-icon>
                                    <div class="titulo" [innerHTML]="submodulo.nombre"></div>
                                </a>
                            </ng-container>
                        </div>
                    </div>
                </ng-container>
            </div>
            <div class="secciones">
                <ng-container *ngFor="let seccion of secciones">
                    <a href="javascript:void();" class="seccion hover" (click)="redirect(seccion)">
                        <div class="principal" [style.background]="seccion.color">
                            <div class="band"></div>
                            <plex-icon class="main" [name]="seccion.icono" size="lg"></plex-icon>
                            <plex-icon class="animated" name="chevron-right" size="lg"></plex-icon>
                        </div>
                        <div class="secundario">
                            <div class="titulo ml-2">{{ seccion.nombre }}</div>
                            <div class="subtitulo ml-2">{{ seccion.subtitulo }}</div>
                        </div>
                        <span class="hover" *ngIf="novedades[seccion._id]?.length > 0" hintType="info"
                              hint="Novedades del módulo {{ seccion.nombre }}" detach="both" hintIcon="bell"
                              (click)="irANovedades(seccion._id)"></span>
                    </a>
                </ng-container>
            </div>
        </main>
        <div *ngIf="denied && !loading" class="denegado" justify="center">
            <main role="main" class="inner">
                <plex-label icon="llave" type="warning" size="xl" direction="column"
                            titulo="No tenés permisos para ningún módulo de ANDES"
                            subtitulo="Ponete en contacto con el informático local o coordinador de área">
                </plex-label>
            </main>
        </div>
    </plex-layout-main>
</plex-layout>