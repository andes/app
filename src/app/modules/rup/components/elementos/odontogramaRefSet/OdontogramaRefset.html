<ng-container *ngIf="conceptos?.length > 0 && params && !soloValores">
    <div class="container odontograma no-gutters p-0">

        <div *ngIf="ultimoOdontograma || odontograma" class="row">
            <div class="col-12">
                <div class="ngx-pop">
                    &nbsp;
                    <span *ngIf="popOverText?.concepto">
                        Diente {{ popOverText.concepto.term }}
                        <span *ngIf="popOverText?.cara && popOverText?.cara === 'anulada'">(pieza ausente)</span>
                        <span *ngIf="popOverText?.cara && popOverText?.cara === 'pieza'">(pieza completa)</span>
                        <span *ngIf="popOverText?.cara && popOverText?.cara !== 'pieza' && popOverText?.cara !== 'anulada'">(cara
                            {{ popOverText.cara }})</span>
                        <ng-container *ngIf="popOverText?.relacion?.length > 0 && showRelacion">
                            <span *ngFor="let rel of popOverText?.relacion">
                                <span *ngIf="rel?.concepto?.term"> - {{ rel.concepto.term }} ({{
                                    rel.concepto.semanticTag }})</span>
                            </span>
                        </ng-container>
                        <ng-container *ngIf="popOverText?.relacion?.concepto && showRelacion">
                            - {{ popOverText.relacion.concepto.term }} ({{ popOverText.relacion.concepto.semanticTag
                            }})
                        </ng-container>
                    </span>
                </div>
            </div>
        </div>

        <!-- ÚLTIMO ODONTOGRAMA -->
        <div class="row no-gutters cargando-odontograma" *ngIf="cargandoUltimoOdontograma">
            <div class="col-12">
                Cargando último odontograma...
            </div>
        </div>
        <div class="row no-gutters último-odontograma p-0 pb-1" *ngIf="ultimoOdontograma" [ngClass]="{'hidden': !showUltimoOdontograma, 'visible': showUltimoOdontograma}">
            <div class="col-12 no-gutters pt-2 title">
                <a class="toggle-último float-right hover btn btn-sm btn-info mdi mdi-chevron-{{ showUltimoOdontograma ? 'up' : 'down' }}"
                    (click)="toggleUltimo()" title="{{ showUltimoOdontograma ? 'Ocultar' : 'Mostrar' }}"></a>
                <h6>
                    <a *ngIf="ultimoOdontogramaIndex > 0" (click)="odontogramaAnterior()" class="hover text-warning text-bold mdi mdi-24px mdi-chevron-left"></a>
                    {{ ultimoOdontogramaIndex === odontogramasHUDS.length - 1 ? 'Último odontograma' : 'Odontograma
                    del' }} {{ (ultimoOdontograma.createdAt | fecha)}}
                    <a *ngIf="ultimoOdontogramaIndex < odontogramasHUDS.length - 1" (click)="odontogramaSiguiente()"
                        class="hover text-warning text-bold mdi mdi-24px mdi-chevron-right"></a>
                </h6>
            </div>
            <ng-container *ngIf="ultimoOdontograma && relaciones">
                <!-- CUADRANTE -->
                <ng-container *ngFor="let cuadrante of cuadrantes">
                    <div class="col-6 no-gutters {{ cuadrante }}" [ngClass]="{'hidden': !showUltimoOdontograma, 'visible': showUltimoOdontograma}">
                        <ng-container *ngFor="let diente of ultimoOdontograma.valor.odontograma[cuadrante]; let i=index">
                            <div class="diente-container text-center">
                                <span class="text-diente">{{ diente.concepto.term }}</span>
                                <svg *ngIf="!piezaAnulada(diente.concepto.conceptId)" xmlns="http://www.w3.org/2000/svg"
                                    xmlns:xlink="http://www.w3.org/1999/xlink" id="cuadrante-sup-der" width="32px"
                                    height="32px" x="0px" y="0px" baseProfile="basic" version="1.1" viewBox="0 0 55 50"
                                    xml:space="preserve">
                                    <path (mouseenter)="showTooltip(diente, 'distal', true)" (mouseleave)="hideTooltip()"
                                        d="M18.042,27.5c0-2.197,0.89-4.187,2.33-5.627l-9.339-9.339c-3.831,3.83-6.2,9.122-6.2,14.966c0,5.845,2.369,11.137,6.2,14.967l9.34-9.34C18.933,31.687,18.042,29.698,18.042,27.5z"
                                        class="diente distal" [ngClass]="'diente-' + classRelacion(diente, 'distal')?.concepto?.semanticTag"
                                        title="distal" />
                                    <ng-container *ngIf="getRegistrosRelAnterior(diente, 'distal')?.length">
                                        <ng-container *ngFor="let reldistal of getRegistrosRelAnterior(diente, 'distal'); let d=index">
                                            <path [ngClass]="{'registrada': caraValor(diente, 'distal') !== -1}" d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                                class="diente distal {{ 'diente-' + reldistal.concepto.semanticTag }} diente-offset-{{d}}"
                                                title="distal" (mouseenter)="showTooltip(diente, 'distal', true, d)"
                                                (mouseleave)="hideTooltip()" />
                                        </ng-container>
                                    </ng-container>
                                    <path (mouseenter)="showTooltip(diente, 'vestibular', true)" (mouseleave)="hideTooltip()"
                                        d="M26,19.542c2.197,0,4.187,0.891,5.627,2.331l9.34-9.339c-3.831-3.831-9.122-6.2-14.967-6.2c-5.845,0-11.137,2.369-14.967,6.2l9.339,9.339C21.813,20.433,23.802,19.542,26,19.542z"
                                        class="diente vestibular" [ngClass]="'diente-' + classRelacion(diente, 'vestibular')?.concepto?.semanticTag"
                                        title="vestibular" />
                                    <ng-container *ngIf="getRegistrosRelAnterior(diente, 'vestibular')?.length">
                                        <ng-container *ngFor="let relvestibular of getRegistrosRelAnterior(diente, 'vestibular'); let v=index">
                                            <path (mouseenter)="showTooltip(diente, 'vestibular', true, v)"
                                                (mouseleave)="hideTooltip()" [ngClass]="{'registrada': caraValor(diente, 'vestibular') !== -1}"
                                                d="M26,19.542c2.197,0,4.187,0.891,5.627,2.331l9.34-9.339c-3.831-3.831-9.122-6.2-14.967-6.2c-5.845,0-11.137,2.369-14.967,6.2l9.339,9.339C21.813,20.433,23.802,19.542,26,19.542z"
                                                class="diente vestibular {{ 'diente-' + relvestibular.concepto.semanticTag }} diente-offset-{{v}}"
                                                title="vestibular" />
                                        </ng-container>
                                    </ng-container>
                                    <path (mouseenter)="showTooltip(diente, 'mesial', true)" (mouseleave)="hideTooltip()"
                                        d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                        class="diente mesial" [ngClass]="'diente-' + classRelacion(diente, 'mesial')?.concepto?.semanticTag"
                                        title="mesial" />
                                    <ng-container *ngIf="getRegistrosRelAnterior(diente, 'mesial')?.length">
                                        <ng-container *ngFor="let relMesial of getRegistrosRelAnterior(diente, 'mesial'); let m=index">
                                            <path (mouseenter)="showTooltip(diente, 'mesial', true, m)" (mouseleave)="hideTooltip()"
                                                [ngClass]="{'registrada': caraValor(diente, 'mesial') !== -1}" d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                                class="diente mesial {{ 'diente-' + relMesial.concepto.semanticTag }} diente-offset-{{m}}"
                                                title="mesial" />
                                        </ng-container>
                                    </ng-container>
                                    <path (mouseenter)="showTooltip(diente, 'palatina', true)" (mouseleave)="hideTooltip()"
                                        d="M26,35.458c-2.198,0-4.188-0.891-5.627-2.331l-9.34,9.34c3.831,3.831,9.122,6.2,14.967,6.2c5.845,0,11.136-2.369,14.966-6.199l-9.34-9.34C30.187,34.567,28.198,35.458,26,35.458z"
                                        class="diente palatina" [ngClass]="'diente-' + classRelacion(diente, 'palatina')?.concepto?.semanticTag"
                                        title="palatina" />
                                    <ng-container *ngIf="getRegistrosRelAnterior(diente, 'palatina')?.length">
                                        <ng-container *ngFor="let relpalatina of getRegistrosRelAnterior(diente, 'palatina'); let p=index">
                                            <path (mouseenter)="showTooltip(diente, 'palatina', true, p)" (mouseleave)="hideTooltip()"
                                                [ngClass]="{'registrada': caraValor(diente, 'palatina') !== -1}" d="M26,35.458c-2.198,0-4.188-0.891-5.627-2.331l-9.34,9.34c3.831,3.831,9.122,6.2,14.967,6.2c5.845,0,11.136-2.369,14.966-6.199l-9.34-9.34C30.187,34.567,28.198,35.458,26,35.458z"
                                                class="diente palatina {{ 'diente-' + relpalatina.concepto.semanticTag }} diente-offset-{{p}}"
                                                title="palatina" />
                                        </ng-container>
                                    </ng-container>
                                    <path (mouseenter)="showTooltip(diente, 'oclusal', true)" (mouseleave)="hideTooltip()"
                                        d="M26,19.542c-2.198,0-4.188,0.891-5.628,2.331c-1.44,1.44-2.33,3.43-2.33,5.627c0,2.198,0.891,4.188,2.331,5.627s3.429,2.331,5.627,2.331c2.197,0,4.187-0.89,5.626-2.33c1.44-1.44,2.332-3.43,2.332-5.628c0-2.197-0.891-4.187-2.331-5.627C30.188,20.433,28.198,19.542,26,19.542z"
                                        class="diente oclusal" [ngClass]="'diente-' + classRelacion(diente, 'oclusal')?.concepto?.semanticTag"
                                        title="oclusal" />
                                    <ng-container *ngIf="getRegistrosRelAnterior(diente, 'oclusal')?.length">
                                        <ng-container *ngFor="let reloclusal of getRegistrosRelAnterior(diente, 'oclusal'); let o=index">
                                            <path (mouseenter)="showTooltip(diente, 'oclusal', false, o)" (mouseleave)="hideTooltip()"
                                                [ngClass]="{ 'registrada': caraValor(diente, 'oclusal') !==- 1}" d="M26,19.542c-2.198,0-4.188,0.891-5.628,2.331c-1.44,1.44-2.33,3.43-2.33,5.627c0,2.198,0.891,4.188,2.331,5.627s3.429,2.331,5.627,2.331c2.197,0,4.187-0.89,5.626-2.33c1.44-1.44,2.332-3.43,2.332-5.628c0-2.197-0.891-4.187-2.331-5.627C30.188,20.433,28.198,19.542,26,19.542z "
                                                class="diente oclusal {{ 'diente-' + reloclusal.concepto.semanticTag }} diente-offset-{{o}} "
                                                title="oclusal" />
                                        </ng-container>
                                    </ng-container>
                                    <ng-container *ngFor="let relClass of getRegistrosRelAnterior(diente, 'pieza'); let a=index">
                                        <g class="pieza" title="pieza completa">
                                            <!-- Círculo MINI -->
                                            <circle (mouseenter)="showTooltip(diente, 'pieza', true, a)" (mouseleave)="hideTooltip()"
                                                class="evolucionada" cx="46.285" cy="7.311" r="5.801" [ngClass]="'diente-' + relClass.concepto.semanticTag + ' rotate-' + a" />
                                        </g>
                                        <!-- Círculo GRANDE -->
                                        <circle *ngIf="ultimoOdontograma && tieneEvolucion(diente, 'pieza')" cx="26" cy="27.5"
                                            r="22.246" [ngClass]="'diente-' + relClass.concepto.semanticTag + '-outline'" />
                                    </ng-container>
                                </svg>
                                <svg *ngIf="piezaAnulada(diente.concepto.conceptId)" xmlns="http://www.w3.org/2000/svg"
                                    xmlns:xlink="http://www.w3.org/1999/xlink" id="cuadrante-sup-der" width="32px"
                                    height="32px" x="0px" y="0px" baseProfile="basic" version="1.1" viewBox="0 0 55 50"
                                    xml:space="preserve">
                                    <g (mouseenter)="showTooltip(diente, 'anulada')" (mouseleave)="hideTooltip()">
                                        <circle class="pieza-anulada" cx="26" cy="27.5" r="22.246">
                                        </circle>
                                        <line fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="3" x1="8"
                                            x2="44" y1="10" y2="44"></line>
                                        <line fill="none" stroke="#FFFFFF" stroke-width="3" stroke-miterlimit="10" x1="8"
                                            x2="44" y1="44" y2="10" />
                                    </g>
                                </svg>
                            </div>
                        </ng-container>
                    </div>
                </ng-container>
            </ng-container>
        </div>
        <!-- FIN ÚLTIMO ODONTOGRAMA -->


        <!-- ODONTOGRAMA DE ESTA CONSULTA -->
        <div *ngIf="!soloValores" class="row no-gutters">
            <div class="col-12 no-gutters pt-3">
                <h6>Odontograma de esta consulta</h6>
            </div>
            <ng-container *ngFor="let cuadrante of cuadrantes">

                <!-- CUADRANTE -->
                <div class="col-6 no-gutters {{ cuadrante }}" *ngIf="odontograma[cuadrante].length">
                    <ng-container *ngFor="let diente of odontograma[cuadrante]; let i=index">
                        <div class="diente-container text-center" *ngIf="(ocultarTemporales && diente.concepto.term >= 51) || diente.concepto.term < 51">
                            <span class="text-diente">{{ diente.concepto.term }}</span>
                            <svg *ngIf="!piezaAnulada(diente.concepto.conceptId)" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" id="cuadrante-sup-der" width="32px" height="32px"
                                x="0px" y="0px" baseProfile="basic" version="1.1" viewBox="0 0 55 50" xml:space="preserve">

                                <!-- DISTAL -->
                                <path (mouseenter)="showTooltip(diente, 'distal', false, 0)" (mouseleave)="hideTooltip()"
                                    (click)="seleccionarDiente(diente, 'distal')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'distal')}"
                                    d="M18.042,27.5c0-2.197,0.89-4.187,2.33-5.627l-9.339-9.339c-3.831,3.83-6.2,9.122-6.2,14.966c0,5.845,2.369,11.137,6.2,14.967l9.34-9.34C18.933,31.687,18.042,29.698,18.042,27.5z"
                                    class="diente distal {{ 'diente-' + getClassRegistro(diente, 'distal')?.concepto.semanticTag }}"
                                    title="distal" />

                                <ng-container *ngIf="getRegistrosRel(diente, 'distal')?.length">
                                    <ng-container *ngFor="let reldistal of getRegistrosRel(diente, 'distal'); let d=index">
                                        <path (mouseenter)="showTooltip(diente, 'distal', false, d)" (mouseleave)="hideTooltip()"
                                            (click)="seleccionarDiente(diente, 'distal')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'distal')}"
                                            d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                            class="diente distal {{ 'diente-' + reldistal.concepto.semanticTag }} diente-offset-{{d}}"
                                            title="distal" />
                                    </ng-container>
                                </ng-container>

                                <!-- VESTIBULAR -->
                                <path (mouseenter)="showTooltip(diente, 'vestibular', false, 0)" (mouseleave)="hideTooltip()"
                                    (click)="seleccionarDiente(diente, 'vestibular')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'vestibular')}"
                                    d="M26,19.542c2.197,0,4.187,0.891,5.627,2.331l9.34-9.339c-3.831-3.831-9.122-6.2-14.967-6.2c-5.845,0-11.137,2.369-14.967,6.2l9.339,9.339C21.813,20.433,23.802,19.542,26,19.542z"
                                    class="diente vestibular {{ 'diente-' + getClassRegistro(diente, 'vestibular')?.concepto.semanticTag }}"
                                    title="vestibular" />

                                <ng-container *ngIf="getRegistrosRel(diente, 'vestibular')?.length">
                                    <ng-container *ngFor="let relvestibular of getRegistrosRel(diente, 'vestibular'); let v=index">
                                        <path (mouseenter)="showTooltip(diente, 'vestibular', false, v)" (mouseleave)="hideTooltip()"
                                            (click)="seleccionarDiente(diente, 'vestibular')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'vestibular')}"
                                            d="M26,19.542c2.197,0,4.187,0.891,5.627,2.331l9.34-9.339c-3.831-3.831-9.122-6.2-14.967-6.2c-5.845,0-11.137,2.369-14.967,6.2l9.339,9.339C21.813,20.433,23.802,19.542,26,19.542z"
                                            class="diente vestibular {{ 'diente-' + relvestibular.concepto.semanticTag }} diente-offset-{{v}}"
                                            title="vestibular" />
                                    </ng-container>
                                </ng-container>

                                <!-- MESIAL -->
                                <path (mouseenter)="showTooltip(diente, 'mesial', false, 0)" (mouseleave)="hideTooltip()"
                                    (click)="seleccionarDiente(diente, 'mesial')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'mesial')}"
                                    d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                    class="diente mesial {{ 'diente-' + getClassRegistro(diente, 'mesial')?.concepto.semanticTag }}"
                                    title="mesial" />

                                <ng-container *ngIf="getRegistrosRel(diente, 'mesial')?.length">
                                    <ng-container *ngFor="let relMesial of getRegistrosRel(diente, 'mesial'); let m=index">
                                        <path (mouseenter)="showTooltip(diente, 'mesial', false, m)" (mouseleave)="hideTooltip()"
                                            (click)="seleccionarDiente(diente, 'mesial')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'mesial')}"
                                            d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                            class="diente mesial {{ 'diente-' + relMesial.concepto.semanticTag }} diente-offset-{{m}}"
                                            title="mesial" />
                                    </ng-container>
                                </ng-container>

                                <!-- PALATINA -->
                                <path (mouseenter)="showTooltip(diente, 'palatina', false, 0)" (mouseleave)="hideTooltip()"
                                    (click)="seleccionarDiente(diente, 'palatina')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'palatina')}"
                                    d="M26,35.458c-2.198,0-4.188-0.891-5.627-2.331l-9.34,9.34c3.831,3.831,9.122,6.2,14.967,6.2c5.845,0,11.136-2.369,14.966-6.199l-9.34-9.34C30.187,34.567,28.198,35.458,26,35.458z"
                                    class="diente palatina {{ 'diente-' + diente?.concepto.semanticTag }}" title="palatina" />

                                <ng-container *ngIf="getRegistrosRel(diente, 'palatina')?.length">
                                    <ng-container *ngFor="let relpalatina of getRegistrosRel(diente, 'palatina'); let p=index">
                                        <path (mouseenter)="showTooltip(diente, 'palatina', false, p)" (mouseleave)="hideTooltip()"
                                            (click)="seleccionarDiente(diente, 'palatina')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'palatina')}"
                                            d="M26,35.458c-2.198,0-4.188-0.891-5.627-2.331l-9.34,9.34c3.831,3.831,9.122,6.2,14.967,6.2c5.845,0,11.136-2.369,14.966-6.199l-9.34-9.34C30.187,34.567,28.198,35.458,26,35.458z"
                                            class="diente palatina {{ 'diente-' + relpalatina.concepto.semanticTag }} diente-offset-{{p}}"
                                            title="palatina" />
                                    </ng-container>
                                </ng-container>

                                <!-- OCLUSAL -->
                                <path (mouseenter)="showTooltip(diente, 'oclusal', false, 0)" (mouseleave)="hideTooltip()"
                                    (click)="seleccionarDiente(diente, 'oclusal')" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'oclusal')}"
                                    d="M26,19.542c-2.198,0-4.188,0.891-5.628,2.331c-1.44,1.44-2.33,3.43-2.33,5.627c0,2.198,0.891,4.188,2.331,5.627s3.429,2.331,5.627,2.331c2.197,0,4.187-0.89,5.626-2.33c1.44-1.44,2.332-3.43,2.332-5.628c0-2.197-0.891-4.187-2.331-5.627C30.188,20.433,28.198,19.542,26,19.542z"
                                    class="diente oclusal {{ 'diente-' + getClassRegistro(diente, 'oclusal')?.concepto.semanticTag }}"
                                    title="oclusal" />
                                <ng-container *ngIf="getRegistrosRel(diente, 'oclusal')?.length">
                                    <ng-container *ngFor="let reloclusal of getRegistrosRel(diente, 'oclusal'); let o=index">
                                        <path (mouseenter)="showTooltip(diente, 'oclusal', false, o)" (mouseleave)="hideTooltip()"
                                            (click)="seleccionarDiente(diente, 'oclusal')" [ngClass]="{ 'registrada': caraValor(diente, 'oclusal') !==- 1}"
                                            d="M26,19.542c-2.198,0-4.188,0.891-5.628,2.331c-1.44,1.44-2.33,3.43-2.33,5.627c0,2.198,0.891,4.188,2.331,5.627s3.429,2.331,5.627,2.331c2.197,0,4.187-0.89,5.626-2.33c1.44-1.44,2.332-3.43,2.332-5.628c0-2.197-0.891-4.187-2.331-5.627C30.188,20.433,28.198,19.542,26,19.542z "
                                            class="diente oclusal {{ 'diente-' + reloclusal.concepto.semanticTag }} diente-offset-{{o}} "
                                            title="oclusal" />
                                    </ng-container>
                                </ng-container>

                                <!-- PIEZA -->
                                <g class="pieza" (click)="seleccionarPieza(diente, 'pieza')" title="pieza completa"
                                    (mouseenter)="showTooltip(diente, false, 0)" (mouseleave)="hideTooltip()">
                                    <!-- Círculo MINI -->
                                    <circle class="st1" [ngClass]="{'seleccionada': estaSeleccionada(diente, 'pieza')}"
                                        cx="46.285" cy="7.311" r="5.801" />
                                    <path [ngClass]="{'seleccionada': estaSeleccionada(diente, 'pieza')}" d="M50.668,5.782l-2.925,1.534l2.925,1.542l-0.674,1.25l-2.951-1.631v3.049h-1.507V8.477l-2.961,1.631l-0.674-1.25l2.961-1.542l-2.961-1.534l0.674-1.25l2.961,1.613V3.096h1.507v3.049l2.951-1.613L50.668,5.782z" />
                                    <!-- Círculo GRANDE -->
                                    <circle cx="26" cy="27.5" r="22.246" [ngClass]="{'seleccionada-outline': estaSeleccionada(diente, 'pieza')}" />
                                </g>
                                <ng-container *ngIf="getRegistrosRel(diente, 'pieza')?.length">
                                    <ng-container *ngFor="let relClass of getRegistrosRel(diente, 'pieza'); let pc=index">
                                        <g title="pieza completa">
                                            <!-- Círculo MINI -->
                                            <circle (mouseenter)="showTooltip(diente, 'pieza', false, pc)" (mouseleave)="hideTooltip()"
                                                class="st1 {{ 'diente-' + relClass.concepto.semanticTag + ' rotate-' + pc }}"
                                                [ngClass]="{'seleccionada': estaSeleccionada(diente, 'pieza')}" cx="46.285"
                                                cy="7.311" r="5.801" />
                                            <!-- Asterisco -->
                                            <path [ngClass]="{'seleccionada': estaSeleccionada(diente, 'pieza')}" class="{{ 'diente-' + relClass.concepto.semanticTag + ' rotate-' + pc }}"
                                                d="M50.668,5.782l-2.925,1.534l2.925,1.542l-0.674,1.25l-2.951-1.631v3.049h-1.507V8.477l-2.961,1.631l-0.674-1.25l2.961-1.542l-2.961-1.534l0.674-1.25l2.961,1.613V3.096h1.507v3.049l2.951-1.613L50.668,5.782z" />
                                            <!-- Círculo GRANDE -->
                                            <circle cx="26" cy="27.5" r="22.246" [ngClass]="{'seleccionada-outline': estaSeleccionada(diente, 'pieza')}"
                                                class="{{ 'diente-' + relClass.concepto.semanticTag + '-outline' }}" />
                                        </g>
                                    </ng-container>
                                </ng-container>
                            </svg>
                            <svg *ngIf="piezaAnulada(diente.concepto.conceptId)" xmlns="http://www.w3.org/2000/"
                                xmlns:xlink="http://www.w3.org/1999/xlink" id="cuadrante-sup-der" width="32px" height="32px"
                                x="0px" y="0px" baseProfile="basic" version="1.1" viewBox="0 0 55 50" xml:space="preserve">
                                <g (mouseenter)="showTooltip(diente, 'anulada')" (mouseleave)="hideTooltip()">
                                    <circle class="pieza completa pieza-anulada" cx="26" cy="27.5" r="22.246">
                                    </circle>
                                    <line fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="3" x1="8"
                                        x2="44" y1="10" y2="44"></line>
                                    <line fill="none" stroke="#FFFFFF" stroke-width="3" stroke-miterlimit="10" x1="8"
                                        x2="44" y1="44" y2="10" />
                                </g>
                            </svg>
                        </div>
                    </ng-container>
                </div>
            </ng-container>

        </div>
        <div class="row d-flex flex-first">
            <div class="col-4">
                <plex-button class="m-0 p-0" name="ocultarTemporales" label="{{ ocultarTemporales ? 'Ocultar piezas temporales' : 'Mostrar piezas temporales' }}"
                    (click)="toggleOcultarTemporales(e)"></plex-button>
            </div>
            <div class="col-4">
                <plex-bool class="m-0 p-0 margin-fix" [(ngModel)]="seleccionMultiple" name="seleccionMultiple" label="Seleccionar piezas/caras múltiples"
                    (click)="limpiarSeleccion(e)"></plex-bool>
            </div>
            <div class="col-4" *ngIf="piezasSeleccionadas?.length > 0">
                <plex-button class="m-0 p-0" name="limpiar-seleccion" label="Limpiar selección" (click)="limpiarSeleccion(e)"></plex-button>
            </div>
        </div>
        <!-- FIN ODONTOGRAMA DE ESTA CONSULTA -->

    </div>

</ng-container>

<!-- ODONTOGRAMA RESUMEN / VALIDACIÓN -->
<ng-container *ngIf="soloValores && registro?.valor?.odontograma?.cuadranteInferiorDerecho?.length> 0">
    <div class="container odontograma no-gutters p-0 readonly">

        <div class="row no-gutters">
            <div class="col-12 no-gutters">
                <h6>Odontograma Registrado</h6>
            </div>
            <div class="col-12 no-gutters">
                <div class="ngx-pop">
                    &nbsp;
                    <span *ngIf="popOverText?.concepto">
                        Diente {{ popOverText.concepto.term }}
                        <span *ngIf="popOverText?.cara && popOverText?.cara !== 'pieza'">(cara {{ popOverText.cara }})</span>
                        <span *ngIf="popOverText?.cara && popOverText?.cara === 'pieza'">(pieza completa)</span>
                        <ng-container *ngIf="popOverText?.relacion?.length > 0 && showRelacion">
                            <span *ngFor="let rel of popOverText?.relacion">
                                <span *ngIf="rel?.concepto?.term"> - {{ rel.concepto.term }} ({{
                                    rel.concepto.semanticTag }})</span>
                            </span>
                        </ng-container>
                        <ng-container *ngIf="popOverText?.relacion?.concepto && showRelacion">
                            - {{ popOverText.relacion.concepto.term }} ({{ popOverText.relacion.concepto.semanticTag
                            }})
                        </ng-container>
                    </span>
                </div>
            </div>

            <ng-container *ngFor="let cuadrante of cuadrantes">
                <div class="col-6 no-gutters {{ cuadrante }}">
                    <ng-container *ngFor="let diente of prestacion.ejecucion.registros[0].valor.odontograma[cuadrante]; let i = index">
                        <div class="diente-container text-center">
                            <span class="text-diente"> {{ diente.concepto.term }}</span>
                            <svg *ngIf="!piezaAnulada(diente.concepto.conceptId)" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" id="cuadrante-sup-der" width="32px" height="32px"
                                x="0px" y="0px" baseProfile="basic" version="1.1" viewBox="0 0 55 50" xml:space="preserve">
                                <path (click)="jumpToId(getClassRegistro(diente,'distal')?.concepto.conceptId)"
                                    (mouseenter)="showTooltip(diente, 'distal', false, 0)" (mouseleave)="hideTooltip()"
                                    [ngClass]="{'registrada': caraValor(diente, 'distal') !== -1}" d="M18.042,27.5c0-2.197,0.89-4.187,2.33-5.627l-9.339-9.339c-3.831,3.83-6.2,9.122-6.2,14.966c0,5.845,2.369,11.137,6.2,14.967l9.34-9.34C18.933,31.687,18.042,29.698,18.042,27.5z"
                                    class="diente distal {{ 'diente-' + getClassRegistro(diente, 'distal')?.concepto.semanticTag }}"
                                    title="distal" />
                                <ng-container *ngIf="getRegistrosRel(diente, 'distal')?.length">
                                    <ng-container *ngFor="let reldistal of getRegistrosRel(diente, 'distal'); let d=index">
                                        <path (click)="jumpToId(getClassRegistro(diente,'distal')?.concepto.conceptId)"
                                            (mouseenter)="showTooltip(diente, 'distal', false, d)" (mouseleave)="hideTooltip()"
                                            [ngClass]="{'registrada': caraValor(diente, 'distal') !== -1}" d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                            class="diente distal {{ 'diente-' + reldistal.concepto.semanticTag }} diente-offset-{{d}}"
                                            title="distal" />
                                    </ng-container>
                                </ng-container>
                                <path (click)="jumpToId(getClassRegistro(diente,'vestibular')?.concepto.conceptId)"
                                    (mouseenter)="showTooltip(diente, 'vestibular', false, 0)" (mouseleave)="hideTooltip()"
                                    [ngClass]="{'registrada': caraValor(diente, 'vestibular') !== -1}" d="M26,19.542c2.197,0,4.187,0.891,5.627,2.331l9.34-9.339c-3.831-3.831-9.122-6.2-14.967-6.2c-5.845,0-11.137,2.369-14.967,6.2l9.339,9.339C21.813,20.433,23.802,19.542,26,19.542z"
                                    class="diente vestibular {{ 'diente-' + getClassRegistro(diente, 'vestibular')?.concepto.semanticTag }}"
                                    title="vestibular" />
                                <ng-container *ngIf="getRegistrosRel(diente, 'vestibular')?.length">
                                    <ng-container *ngFor="let relvestibular of getRegistrosRel(diente, 'vestibular'); let v=index">
                                        <path (click)="jumpToId(getClassRegistro(diente,'vestibular')?.concepto.conceptId)"
                                            (mouseenter)="showTooltip(diente, 'vestibular', false, v)" (mouseleave)="hideTooltip()"
                                            [ngClass]="{'registrada': caraValor(diente, 'vestibular') !== -1}" d="M26,19.542c2.197,0,4.187,0.891,5.627,2.331l9.34-9.339c-3.831-3.831-9.122-6.2-14.967-6.2c-5.845,0-11.137,2.369-14.967,6.2l9.339,9.339C21.813,20.433,23.802,19.542,26,19.542z"
                                            class="diente vestibular {{ 'diente-' + relvestibular.concepto.semanticTag }} diente-offset-{{v}}"
                                            title="vestibular" />
                                    </ng-container>
                                </ng-container>
                                <path (mouseenter)="showTooltip(diente, 'mesial', false, 0)" (mouseleave)="hideTooltip()"
                                    (click)="jumpToId(getClassRegistro(diente,'mesial')?.concepto.conceptId)" [ngClass]="{'registrada': caraValor(diente, 'mesial') !== -1}"
                                    d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                    class="diente mesial {{ 'diente-' + getClassRegistro(diente, 'mesial')?.concepto.semanticTag }}"
                                    title="mesial" />
                                <ng-container *ngIf="getRegistrosRel(diente, 'mesial')?.length">
                                    <ng-container *ngFor="let relMesial of getRegistrosRel(diente, 'mesial'); let m=index">
                                        <path (click)="jumpToId(getClassRegistro(diente,'mesial')?.concepto.conceptId)"
                                            (mouseenter)="showTooltip(diente, 'mesial', false, m)" (mouseleave)="hideTooltip()"
                                            [ngClass]="{'registrada': caraValor(diente, 'mesial') !== -1}" d="M40.967,12.533l-9.34,9.339c1.44,1.44,2.331,3.43,2.331,5.627c0,2.198-0.891,4.188-2.332,5.628l9.34,9.34c3.831-3.831,6.2-9.123,6.2-14.968C47.167,21.655,44.797,16.363,40.967,12.533z"
                                            class="diente mesial {{ 'diente-' + relMesial.concepto.semanticTag }} diente-offset-{{m}}"
                                            title="mesial" />
                                    </ng-container>
                                </ng-container>
                                <path (click)="jumpToId(getClassRegistro(diente,'palatina')?.concepto.conceptId)"
                                    (mouseenter)="showTooltip(diente, 'palatina', false, 0)" (mouseleave)="hideTooltip()"
                                    [ngClass]="{'registrada': caraValor(diente, 'palatina') !== -1}" d="M26,35.458c-2.198,0-4.188-0.891-5.627-2.331l-9.34,9.34c3.831,3.831,9.122,6.2,14.967,6.2c5.845,0,11.136-2.369,14.966-6.199l-9.34-9.34C30.187,34.567,28.198,35.458,26,35.458z "
                                    class="diente palatina {{ caraValor(diente, 'palatina') !==- 1 ? 'diente-' + getClassRegistro(diente,'palatina')?.concepto.semanticTag : '' }}"
                                    title="palatina" />
                                <ng-container *ngIf="getRegistrosRel(diente, 'palatina')?.length">
                                    <ng-container *ngFor="let relpalatina of getRegistrosRel(diente, 'palatina'); let p=index">
                                        <path (click)="jumpToId(getClassRegistro(diente,'palatina')?.concepto.conceptId)"
                                            (mouseenter)="showTooltip(diente, 'palatina', false, p)" (mouseleave)="hideTooltip()"
                                            [ngClass]="{ 'registrada': caraValor(diente, 'palatina') !==- 1}" d="M26,35.458c-2.198,0-4.188-0.891-5.627-2.331l-9.34,9.34c3.831,3.831,9.122,6.2,14.967,6.2c5.845,0,11.136-2.369,14.966-6.199l-9.34-9.34C30.187,34.567,28.198,35.458,26,35.458z "
                                            class="diente palatina {{ 'diente-' + relpalatina.concepto.semanticTag }} diente-offset-{{p}} "
                                            title="palatina" />
                                    </ng-container>
                                </ng-container>
                                <path (click)="jumpToId(getClassRegistro(diente,'oclusal')?.concepto.conceptId)"
                                    (mouseenter)="showTooltip(diente, 'oclusal', false, 0)" (mouseleave)="hideTooltip()"
                                    [ngClass]="{ 'registrada': caraValor(diente, 'oclusal') !==- 1} " d="M26,19.542c-2.198,0-4.188,0.891-5.628,2.331c-1.44,1.44-2.33,3.43-2.33,5.627c0,2.198,0.891,4.188,2.331,5.627s3.429,2.331,5.627,2.331c2.197,0,4.187-0.89,5.626-2.33c1.44-1.44,2.332-3.43,2.332-5.628c0-2.197-0.891-4.187-2.331-5.627C30.188,20.433,28.198,19.542,26,19.542z "
                                    class="diente oclusal {{ 'diente-' + getClassRegistro(diente, 'oclusal')?.concepto.semanticTag }} "
                                    title="oclusal" />
                                <ng-container *ngIf="getRegistrosRel(diente, 'oclusal')?.length">
                                    <ng-container *ngFor="let reloclusal of getRegistrosRel(diente, 'oclusal'); let o=index">
                                        <path (click)="jumpToId(getClassRegistro(diente,'oclusal')?.concepto.conceptId)"
                                            (mouseenter)="showTooltip(diente, 'oclusal', false, o)" (mouseleave)="hideTooltip()"
                                            [ngClass]="{ 'registrada': caraValor(diente, 'oclusal') !==- 1}" d="M26,19.542c-2.198,0-4.188,0.891-5.628,2.331c-1.44,1.44-2.33,3.43-2.33,5.627c0,2.198,0.891,4.188,2.331,5.627s3.429,2.331,5.627,2.331c2.197,0,4.187-0.89,5.626-2.33c1.44-1.44,2.332-3.43,2.332-5.628c0-2.197-0.891-4.187-2.331-5.627C30.188,20.433,28.198,19.542,26,19.542z "
                                            class="diente oclusal {{ 'diente-' + reloclusal.concepto.semanticTag }} diente-offset-{{o}} "
                                            title="oclusal" />
                                    </ng-container>
                                </ng-container>

                                <!-- PIEZA COMPLETA -->
                                <g class="pieza" title="pieza completa" (click)="jumpToId(getClassRegistro(diente,'pieza')?.concepto.conceptId)"
                                    (mouseenter)="showTooltip(diente, 'pieza', false, 0)">
                                    <!-- Círculo MINI -->
                                    <circle class="st1" [ngClass]="piezaCompletaValor(diente, 'pieza') !== -1 ? 'diente-' + getClassRegistro(diente, 'pieza')?.concepto.semanticTag : '' "
                                        cx="46.285" cy="7.311" r="5.801" />
                                    <!-- Asterisco -->
                                    <path [ngClass]="piezaCompletaValor(diente, 'pieza') !== -1 ? 'diente-' + getClassRegistro(diente, 'pieza')?.concepto.semanticTag + '-outline' : '' "
                                        d="M50.668,5.782l-2.925,1.534l2.925,1.542l-0.674,1.25l-2.951-1.631v3.049h-1.507V8.477l-2.961,1.631l-0.674-1.25l2.961-1.542l-2.961-1.534l0.674-1.25l2.961,1.613V3.096h1.507v3.049l2.951-1.613L50.668,5.782z " />
                                </g>
                                <ng-container *ngIf="getRegistrosRel(diente, 'pieza')?.length">
                                    <ng-container *ngFor="let relClass of getRegistrosRel(diente, 'pieza'); let a=index">
                                        <g (mouseenter)="showTooltip(diente, 'pieza', false, a)" (mouseleave)="hideTooltip()"
                                            class="pieza" title="pieza completa">
                                            <!-- Círculo MINI -->
                                            <circle *ngIf="relClass?.concepto?.semanticTag" cx="46.285" cy="7.311" r="5.801"
                                                class="st1" [ngClass]="'diente-' + relClass.concepto.semanticTag + ' rotate-'+ a" />
                                            <path [ngClass]="'diente-' + getClassRegistro(diente,'pieza')?.concepto.semanticTag"
                                                d="M50.668,5.782l-2.925,1.534l2.925,1.542l-0.674,1.25l-2.951-1.631v3.049h-1.507V8.477l-2.961,1.631l-0.674-1.25l2.961-1.542l-2.961-1.534l0.674-1.25l2.961,1.613V3.096h1.507v3.049l2.951-1.613L50.668,5.782z " />
                                        </g>
                                        <!-- Círculo GRANDE -->
                                        <circle cx="26" cy="27.5" r="22.246" [ngClass]=" 'diente-' + relClass.concepto.semanticTag+ '-outline'" />
                                    </ng-container>
                                </ng-container>
                            </svg>
                            <svg *ngIf="piezaAnulada(diente.concepto.conceptId)" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" id="cuadrante-sup-der" width="32px" height="32px"
                                x="0px" y="0px" baseProfile="basic" version="1.1 " viewBox="0 0 55 50" xml:space="preserve">
                                <g (mouseenter)="showTooltip(diente, 'anulada')" (mouseleave)="hideTooltip()">
                                    <circle class="pieza completa pieza-anulada" cx="26" cy="27.5" r="22.246">
                                    </circle>
                                    <line fill="none" stroke="#FFFFFF" stroke-miterlimit="10" stroke-width="3" x1="8"
                                        x2="44" y1="10" y2="44"></line>
                                    <line fill="none" stroke="#FFFFFF" stroke-width="3" stroke-miterlimit="10" x1="8"
                                        x2="44" y1="44" y2="10" />
                                </g>
                            </svg>
                        </div>
                    </ng-container>
                </div>
            </ng-container>

        </div>
    </div>

</ng-container>
