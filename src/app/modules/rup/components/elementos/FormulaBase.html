<!-- Moléculas -->
<ng-container *ngIf="elementoRUP.requeridos?.length">
    <plex-wrapper class="w-100">
        <plex-grid cols="2">
            <ng-container *ngIf="!valorManual">
                <ng-container *ngFor="let item of elementoRUP.requeridos; let i = index">
                    <div *ngIf="item.elementoRUP" class="pr-3">
                        <rup [ngClass]="{'readonly': valorManual}" [elementoRUP]="item.elementoRUP"
                                [paciente]="paciente" [params]="item.params" [prestacion]="prestacion"
                                [registro]="registro.registros[i]" [soloValores]="soloValores" (change)="emitChange2()"
                                (ejecutarAccion)="emitEjecutarAccion($event)" [habilitado]="valorManual">
                        </rup>
                    </div>
                </ng-container>
            </ng-container>
            <ng-container *ngIf="valorManual">
                <ng-container *ngFor="let item of elementoRUP.requeridos; let i = index">
                    <div *ngIf="item.elementoRUP" class="pr-3">
                        <rup [ngClass]="{'readonly': !valorManual}" [elementoRUP]="item.elementoRUP"
                                [paciente]="paciente" [params]="item.params" [prestacion]="prestacion"
                                [registro]="registro.registros[i]" [soloValores]="soloValores" (change)="emitChange2()"
                                (ejecutarAccion)="emitEjecutarAccion($event)" [habilitado]="valorManual">
                        </rup>
                    </div>
                </ng-container>
            </ng-container>

            <div class="d-flex align-items-center w-100">
                <div class="w-100">
                    <label> {{ registro.concepto.term}} </label>
                    <!-- Valor/resultado del cálculo -->
                    <ng-container *ngIf="soloValores || !valorEditable">
                        <p>
                            <ng-container *ngIf="!hasRules">
                                {{registro.valor}}
                            </ng-container>
                            <plex-badge [type]="mensaje.type" *ngIf="mensaje?.texto">
                                {{ mensaje.texto }}
                                <plex-button *ngIf="mensaje.add && !soloValores" (click)="addConcepto(mensaje.add)"
                                            title="Registrar">
                                    <plex-icon name="plus"></plex-icon>
                                </plex-button>
                            </plex-badge>
                        </p>
                    </ng-container>
                    <!-- Campo para ingreso manual del valor del registro -->
                    <ng-container *ngIf="!soloValores && valorEditable">
                        <plex-float *ngIf="valorManual" placeholder="Ingrese un valor" [(ngModel)]="registro.valor"
                                    label='' name="valorCalculo" [readonly]="soloValores" (change)="emitChange2()"
                                    [disabled]="!valorManual">
                        </plex-float>
                        <plex-float *ngIf="!valorManual" [(ngModel)]="registro.valor" required="true" [disabled]="true">
                        </plex-float>
                    </ng-container>
                </div>
                <div *ngIf="!soloValores && valorEditable" class="d-flex align-items-start mt-2">
                    <plex-button *ngIf="!valorManual" type="warning" icon="pencil" (click)="changeValorManual(true)"
                                tooltip="Agregar manualmente" tooltipPosition="left">
                    </plex-button>
                    <plex-button *ngIf="valorManual" class="mr-1" type="danger" icon="close"
                                (click)="changeValorManual(false)">
                    </plex-button>
                </div>
            </div>
        </plex-grid>
    </plex-wrapper>
</ng-container>