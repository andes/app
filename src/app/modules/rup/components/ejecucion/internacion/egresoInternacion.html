<form #formEgreso="ngForm">

    <section>
        <div class="row" *ngIf="prestacion && registro.valor">
            <div class="col-12">
                <plex-box>
                    <ng-container>
                        <div class="row">
                            <div class="col-6">
                                <plex-datetime name="fecha-hora" label="Fecha y hora " type="datetime" [(ngModel)]="registro.valor.InformeEgreso.fechaEgreso"
                                    required>
                                </plex-datetime>
                            </div>
                            <div class="col-6">
                                <plex-select (change)="selecOrganizacionDestino()" label="Tipo de egreso" [(ngModel)]="registro.valor.InformeEgreso.tipoEgreso"
                                    name="InformeEgreso.tipoEgreso" [data]="listaTipoEgreso" placeholder="Seleccione..." required>
                                </plex-select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <plex-select *ngIf="listaUnidadesOrganizativas?.length > 0" label="Unidad organizativa de destino" [(ngModel)]="registro.valor.InformeEgreso.UnidadOrganizativaDestino"
                                    name="InformeEgreso.UnidadOrganizativaDestino" [data]="listaUnidadesOrganizativas" placeholder="Seleccione..."
                                    required>
                                </plex-select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col">
                                <plex-select (change)="showProcedimientos_causas()" label="Diagnostico Principal al egreso" [(ngModel)]="registro.valor.InformeEgreso.diagnosticoPrincipal"
                                    name="diagnosticoPrincipal" (getData)="codigoCIE10($event)" placeholder="buscar..." labelField="nombre"
                                    required>
                                </plex-select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <plex-select label="Otros Diagnósticos" [(ngModel)]="registro.valor.InformeEgreso.otrosDiagnosticos" name="otrosDiagnosticos"
                                    (getData)="codigoCIE10($event)" [multiple]="true" placeholder="buscar..." labelField="nombre"
                                    required>
                                </plex-select>
                            </div>
                        </div>
                        <ng-container *ngIf="listaProcedimientosQuirurgicos && listaProcedimientosQuirurgicos.length > 0">
                            <div class="row" *ngFor=" let procedimiento of registro.valor.InformeEgreso.procedimientosQuirurgicos; let i = index ">

                                <div class="col-6">
                                    <plex-select label="Procedimientos Quirúrgicos" [(ngModel)]="procedimiento.procedimientosQuirurgicos" name="InformeEgreso.procedimientoQuirurgico"
                                        [data]="listaProcedimientosQuirurgicos" placeholder="Seleccione..." labelField="nombre">
                                    </plex-select>
                                </div>
                                <div class="col-5">
                                    <plex-datetime name="fecha-procedimientoQuirurgico" label="Fecha" type="date" [(ngModel)]="procedimiento.fecha">
                                    </plex-datetime>
                                </div>
                                <div class="col-1 pt-1">
                                    <plex-button *ngIf="i > 0" label="" type="danger btn-sm" icon="close" (click)="removeProcedimiento(i)"></plex-button>
                                </div>
                            </div>
                            <plex-button label="Agregar" type="primary btn-sm" icon="" (click)="addProcedimientoQuirurgico()"></plex-button>
                        </ng-container>
                        <div class="row">
                            <div class="col-12">
                                <plex-select label="Otras circunstancias que prolongan la internación" [(ngModel)]="registro.valor.InformeEgreso.otrasCircunstancias"
                                    name="otrasCircunstancias" (getData)="codigoCIE10($event)" placeholder="buscar...">
                                </plex-select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <plex-int name="diasDeEstada" label="Días de estada por otras circunstancias" suffix="Días" [(ngModel)]="registro.valor.InformeEgreso.diasEstadaOtrasCircunstancias"
                                    placeholder=""></plex-int>
                            </div>
                            <div class="col-6">
                                <label></label>
                                <plex-int name="diasDePermisoDeSalida" label="Días de permiso de salida" suffix="Días" [(ngModel)]="registro.valor.InformeEgreso.diasDePermisoDeSalida"
                                    placeholder=""></plex-int>
                            </div>
                        </div>
                        <div class="row">&nbsp;</div>
                        <div *ngIf="ExisteCausaExterna" class="row">
                            <div class="col">
                                <plex-select label="Producido por:" [(ngModel)]="registro.valor.InformeEgreso.causaExterna.producidaPor" name="producidaPor"
                                    [data]="causaExterna.producidaPor" placeholder="Seleccione..." labelField="nombre">
                                </plex-select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <plex-select label="Lugar donde ocurrio" [(ngModel)]="registro.valor.InformeEgreso.causaExterna.lugar" name="lugar" [data]="causaExterna.lugar"
                                    placeholder="Seleccione..." labelField="nombre">
                                </plex-select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <plex-select label="Como se produjo" [(ngModel)]="registro.valor.InformeEgreso.causaExterna.comoSeProdujo" name="comoSeProdujo"
                                    (getData)="searchComoSeProdujo($event)" placeholder="Buscar..." labelField="nombre">
                                </plex-select>
                            </div>
                        </div>

                        <div class="row">&nbsp;</div>
                        <div *ngIf="procedimientosObstetricos">
                            <div class="row">
                                <div class="col-4">
                                    <plex-datetime name="fechaTerminacion" label="Fecha terminación" type="date" [(ngModel)]="registro.valor.InformeEgreso.terminacionEmbarazo"
                                        required>
                                    </plex-datetime>
                                </div>
                                <div class="col-4">
                                    <plex-int name="edadGestacional" label="Edad gestacional" [(ngModel)]="registro.valor.InformeEgreso.edadGestacional" placeholder=""
                                        required></plex-int>
                                </div>
                                <div class="col-4">
                                    <plex-int name="paridad" label="Paridad" [(ngModel)]="registro.valor.InformeEgreso.paridad" placeholder="" required></plex-int>
                                </div>
                            </div>
                            <div class="row">

                                <div class="col-12">
                                    <label>Tipo de parto</label>
                                    <label class="custom-control custom-radio">
                                        <input class="custom-control-input" name="tipoParto" value="Simple" [(ngModel)]="registro.valor.InformeEgreso.tipoParto"
                                            type="radio">
                                        <span class="custom-control-indicator"></span>
                                        <span class="custom-control-description"> Simple</span>
                                    </label>
                                    <label class="custom-control custom-radio">
                                        <input class="custom-control-input" name="tipoParto" value="Multiple" [(ngModel)]="registro.valor.InformeEgreso.tipoParto"
                                            type="radio">
                                        <span class="custom-control-indicator"></span>
                                        <span class="custom-control-description"> Multiple</span>
                                    </label>
                                </div>
                            </div>

                            <ng-container *ngFor=" let nacimiento of registro.valor.InformeEgreso.nacimientos; let i = index ">
                                <div class="row">
                                    <div class="col-6">
                                        <plex-int suffix="g" name="peso-{{i}}" label="Peso al nacer" [(ngModel)]="nacimiento.pesoAlNacer" placeholder="" required></plex-int>
                                    </div>

                                    <div class="col-6">
                                        <label>Condición al nacer</label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="condicionAlNacer-{{i}}" value="NacVivo" [(ngModel)]="nacimiento.condicionAlNacer"
                                                type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Nac. vivo</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="condicionAlNacer-{{i}}" value="defFetal" [(ngModel)]="nacimiento.condicionAlNacer"
                                                type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Def. fetal</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="row">

                                    <div class="col-6">
                                        <label>Terminación</label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="Terminacion-{{i}}" value="Simple" [(ngModel)]="nacimiento.terminacion" type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Vaginal</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="Terminacion-{{i}}" value="Multiple" [(ngModel)]="nacimiento.terminacion" type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Cesária</span>
                                        </label>
                                    </div>
                                    <div class="col-5">
                                        <label>Sexo</label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="sexo-{{i}}" value="Masculino" [(ngModel)]="nacimiento.sexo" type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Masculino</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="sexo-{{i}}" value="Femenino" [(ngModel)]="nacimiento.sexo" type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Femenino</span>
                                        </label>
                                        <label class="custom-control custom-radio">
                                            <input class="custom-control-input" name="sexo-{{i}}" value="Indeterminado" [(ngModel)]="nacimiento.sexo" type="radio">
                                            <span class="custom-control-indicator"></span>
                                            <span class="custom-control-description"> Indeterminado</span>
                                        </label>
                                    </div>
                                    <div class="col-1">
                                        <plex-button *ngIf="i > 0" label="" type="danger btn-sm" icon="close" (click)="removeNacimiento(i)"></plex-button>
                                    </div>
                                </div>

                            </ng-container>
                            <plex-button *ngIf="registro.valor.InformeEgreso.tipoParto == 'Multiple'" label="Agregar" type="primary btn-sm" icon="" (click)="addNacimiento()"></plex-button>
                        </div>


                    </ng-container>
                </plex-box>
            </div>
        </div>
    </section>

</form>
<!-- <ng-container *ngIf="soloValores && registro.valor.InformeEgreso">
    <div class="row">
        <div class="col-3">
            <label class="block">Fecha de egreso</label>
            <span>{{registro.valor.InformeEgreso.fechaEgreso | date }}</span>
        </div>
        <div class="col-3" *ngIf="registro.valor.InformeEgreso.tipoEgreso">
            <label class="block">Tipo de egreso</label>
            <span>{{registro.valor.InformeEgreso.tipoEgreso.nombre }}</span>
        </div>

    </div>
    <div class="row" *ngIf="registro.valor.InformeEgreso.diagnosticoPrincipal">
        <div class="col">
            <label class="block">Diagnostico Principal al egreso</label>
            <span>{{registro.valor.InformeEgreso.diagnosticoPrincipal.codigo}} - {{registro.valor.InformeEgreso.diagnosticoPrincipal.nombre}}</span>
        </div>
    </div>

    <div class="row" *ngIf="registro.valor.InformeEgreso.otrosDiagnosticos">
        <div class="col-12">
            <label class="block">Otros Diagnósticos</label>
            <ul class="list-unstyled">
                <li class="" *ngFor="let otroDiagnostico of registro.valor.InformeEgreso.otrosDiagnosticos">
                    {{ otroDiagnostico.nombre }}
                </li>
            </ul>
        </div>
    </div>
    <div class="row" *ngIf="registro.valor.InformeEgreso.procedimientosQuirurgicos">
        <div class="col-12" *ngIf="registro.valor.InformeEgreso.procedimientosQuirurgicos.length">
            <label class="block">Procedimientos Quirurgicos</label>
            <ul class="list-unstyled">
                <li class="" *ngFor="let procedimiento of registro.valor.InformeEgreso.procedimientosQuirurgicos">
                    <span *ngIf="procedimiento.procedimientosQuirurgicos">{{ procedimiento.procedimientosQuirurgicos.nombre }} |</span>
                    <span *ngIf="procedimiento.fecha">fecha: {{procedimiento.fecha | date}}</span>
                </li>
            </ul>
        </div>
    </div>

    <div class="row" *ngIf="registro.valor.InformeEgreso.causaExterna">
        <div class="col-12">
            <p class="title">
                Causa externa de traumatismo, envenenamiento y otros efectos adversos
            </p>
        </div>
    </div>

    <div class="row" *ngIf="registro.valor.InformeEgreso.causaExterna">
        <div class="col-4">
            <label class="block">Producido por</label>
            <span>{{registro.valor.InformeEgreso.causaExterna.producidaPor.nombre}}</span>
        </div>
        <div class="col-4">
            <label class="block">Lugar donde ocurrio</label>
            <span>{{registro.valor.InformeEgreso.causaExterna.lugar.nombre }}</span>
        </div>
        <div class="col-4">
            <label class="block">Como se produjo</label>
            <span>{{registro.valor.InformeEgreso.causaExterna.comoSeProdujo.nombre }}</span>
        </div>
    </div>

    <div class="row" *ngIf="registro.valor.InformeEgreso.terminacionEmbarazo">
        <div class="col-12">
            <p class="title">
                Datos del evento obstétrico
            </p>
        </div>
    </div>
    <div class="row" *ngIf="registro.valor.InformeEgreso.terminacionEmbarazo">
        <div class="col-3">
            <label class="block">Fecha terminación</label>
            <span>{{registro.valor.InformeEgreso.terminacionEmbarazo | date}}</span>
        </div>
        <div class="col-3">
            <label class="block">Edad gestacional</label>
            <span>{{registro.valor.InformeEgreso.edadGestacional}}</span>
        </div>
        <div class="col-3">
            <label class="block">Paridad</label>
            <span>{{registro.valor.InformeEgreso.paridad}}</span>
        </div>
        <div class="col-3">
            <label class="block"> Tipo de parto</label>
            <span>{{registro.valor.InformeEgreso.tipoParto}}</span>
        </div>

    </div>
    <ng-container *ngIf="registro.valor.InformeEgreso.nacimientos">
        <div class="row" *ngFor="let unNacimiento of registro.valor.InformeEgreso.nacimientos">
            <div class="col-3" *ngIf="unNacimiento.peso">
                <label class="block">Peso al nacer</label>
                <span>{{unNacimiento.peso}}</span>
            </div>
            <div class="col-3" *ngIf="unNacimiento.condicionAlNacer">
                <label class="block">Condición al nacerl</label>
                <span>{{unNacimiento.condicionAlNacer}}</span>
            </div>
            <div class="col-3" *ngIf="unNacimiento.terminacion">
                <label class="block">Terminación</label>
                <span>{{unNacimiento.terminacion}}</span>
            </div>
            <div class="col-3" *ngIf="unNacimiento.sexo">
                <label class="block"> Sexo </label>
                <span>{{unNacimiento.sexo}}</span>
            </div>

        </div>
    </ng-container>

</ng-container> -->

<footer>
    <div class="row">
        <div class="col-6 text-left">
            <plex-button class="float-left " type="danger " label="Cerrar" (click)="cancelar() "></plex-button>
        </div>
        <div class="col-6 text-right">
            <plex-button *ngIf="prestacion && prestacion.estados[prestacion.estados.length - 1].tipo !='validada' " label="Guardar" (click)="guardarPrestacion(formEgreso.form.valid) "
                type="success " class="float-right "></plex-button>

            <!-- <plex-button *ngIf="prestacion  && prestacion.estados[prestacion.estados.length - 1].tipo !='validada' " label="Validar Internación "
                (click)="validar() " type="success " class="float-right "></plex-button> -->

            <plex-button *ngIf="prestacion && prestacion.estados[prestacion.estados.length - 1].tipo==='validada' " label="Romper Validación"
                (click)="romperValidacion() " type="danger " class="float-right "></plex-button>
        </div>
    </div>
</footer>