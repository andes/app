<plex-layout [main]="6">
    <plex-layout-main>
        <selectorUsuarioEfector (seleccionOrganizacion)="seleccionOrganizacion($event)" (seleccionUsuario)="seleccionUsuario($event)"></selectorUsuarioEfector>
    </plex-layout-main>
    <plex-layout-sidebar>
        <plex-tabs [activeIndex]="pestaniaActiva" (change)="cambio($event)">

            <plex-tab label="Visualizar permisos" color="procedimiento">
                <permisosVisualizacion *ngIf="usuarioSeleccionado && organizacionSeleccionada && prestacionesTurneables"
                    [user]="usuarioSeleccionado" [org]="organizacionSeleccionada" [permiteAsignarPerfiles]="false"
                    [arbolPermisosCompleto]="arbolPermisosCompleto" [permisosUsuario]='permisosUsuarioOrg'
                    [prestacionesTurneables]="prestacionesTurneables"></permisosVisualizacion>
                <div *ngIf="!usuarioSeleccionado || !organizacionSeleccionada" class="mt-5">
                    <i class="mdi mdi-emoticon-sad"></i>Seleccione un usuario y organización para visualizar sus
                    permisos</div>
            </plex-tab>

            <plex-tab label="Editar permisos">
                <div *ngIf="usuarioSeleccionado && organizacionSeleccionada" class="row">
                    <div class="col d-flex justify-content-end">
                        <plex-button type="danger" label="Cancelar" (click)="cancelar()"></plex-button>
                        <plex-button type="success" label="Guardar" (click)="guardar($event)"></plex-button>
                    </div>
                </div>
                <div *ngIf="usuarioSeleccionado && organizacionSeleccionada" class="row">
                    <div class="col-12 mb-2">
                        <div class="page-title">PERFILES</div>
                    </div>
                    <div class="col" *ngIf="permisosUsuarioOrg && prestacionesTurneables">
                        <permisosVisualizacion [user]="usuarioSeleccionado" [org]="organizacionSeleccionada"
                            [permiteAsignarPerfiles]="true" (seleccionCheckboxPerfil)="seleccionPerfil($event)"
                            [arbolPermisosCompleto]="arbolPermisosCompleto" [permisosUsuario]='permisosUsuarioOrg'
                            [prestacionesTurneables]="prestacionesTurneables"></permisosVisualizacion>
                    </div>
                </div>
                <div *ngIf="usuarioSeleccionado && organizacionSeleccionada" class="row">
                    <div class="col-12 mb-2">
                        <div class="page-title mt-5">PERMISOS</div>
                    </div>
                    <div class="col" *ngIf="permisosUsuarioOrg && prestacionesTurneables">
                        <div *ngFor="let permiso of permisos$ | async">
                            <arbolPermisos [item]="permiso" [userPermissions]='permisosUsuarioOrg' (seleccionPermiso)="seleccionPermiso($event)"
                                [prestacionesTurneables]="prestacionesTurneables"></arbolPermisos>
                        </div>
                    </div>
                </div>
                <div *ngIf="!usuarioSeleccionado || !organizacionSeleccionada" class="row">
                    <div class="col mt-5">
                        <i class="mdi mdi-emoticon-sad"></i>Seleccione un usuario y organización para editar sus
                        permisos
                    </div>
                </div>

            </plex-tab>
        </plex-tabs>
    </plex-layout-sidebar>
</plex-layout>
