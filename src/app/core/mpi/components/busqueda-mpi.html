<plex-layout main="{{ sidebar }}">
    <plex-layout-main>
        <paciente-buscar #buscador (searchStart)="onSearchStart()"
                         (searchEnd)="onSearchEnd($event.pacientes,$event.escaneado, $event.busqueda)"
                         (searchClear)="onSearchClear()" [hostComponent]="'mpi'" [create]="true"
                         [returnScannedPatient]="true" [scrolling]="true">
        </paciente-buscar>

        <plex-loader *ngIf="loading" type="ball-pulse"></plex-loader>

        <paciente-listado *ngIf="resultadoBusqueda && resultadoBusqueda.length" [pacientes]="resultadoBusqueda"
                          [autoselect]="false" [editing]="true" (selected)="toVisualize($event)" (edit)="toEdit($event)"
                          (scrolled)="toPacienteBuscarOnScroll(resultadoBusqueda)">
        </paciente-listado>
        <div *ngIf="resultadoBusqueda && !resultadoBusqueda.length && !searchClear" class="alert alert-danger">
            <i class="mdi mdi-account-alert"></i> No se encontró ningún paciente..
        </div>
    </plex-layout-main>


    <plex-layout-sidebar [type]="'invert'">
        <!-- historial de búsquedas -->
        <ng-container *ngIf="!showDetallePaciente">
            <plex-title size="md" titulo="Busquedas recientes"></plex-title>

            <paciente-listado [pacientes]="historialSeleccionados" [autoselect]="false" (selected)="toEdit($event)">
            </paciente-listado>
        </ng-container>

        <!-- detalles del paciente a visualizar -->
        <ng-container *ngIf="showDetallePaciente">
            <plex-title titulo="Detalle paciente" size="sm">
                <plex-button type="danger" icon="close" class="ml-2" size="sm" (click)="closeDetallePaciente()">
                </plex-button>
            </plex-title>

            <paciente-detalle [paciente]="paciente" [showRelaciones]="true" reload="true" [fields]="fieldsDetalle">
            </paciente-detalle>
        </ng-container>

    </plex-layout-sidebar>
</plex-layout>