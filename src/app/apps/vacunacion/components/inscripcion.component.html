<plex-layout>
    <plex-layout-main>
        <plex-title titulo="Inscripción a vacunación Covid 19">
            <plex-button label="Guardar" type="info" 
            [disabled]="!recaptcha || !formulario.valid" [validateForm]="formulario" (click)="guardar()">
            </plex-button>
            <plex-button label="Cancelar" type="danger" (click)="cancelar()"> </plex-button>
        </plex-title>
        <div class="row w-100">
            <div class="col-2">
            </div>
            <div class="col-6">
                <div class="row mb-3">
                    <div class="col-12">
                        <plex-label titulo="Completá los datos para realizar la petición de turno de vacunación"
                                    size="lg">
                        </plex-label>
                    </div>
                </div>
                <form #formulario="ngForm">
                    <plex-grid type="full" cols="2">
                        <plex-select [(ngModel)]="ciudadano.grupo" label="Seleccione grupo" [data]="opcionesGrupos" name="grupo" 
                            [required]="true" (change)="seleccionaGrupo()">
                        </plex-select>
                        <plex-text email label="email" name="email" debounce="900" [(ngModel)]="ciudadano.email"
                            placeholder="maria@gmail.com" [required]="true">
                        </plex-text>
                        <plex-text [(ngModel)]="ciudadano.documento" (change)="limpiarRespuesta()" name="documento"
                                   label="Documento" [required]="true">
                        </plex-text>
                        <plex-text [(ngModel)]="ciudadano.nroTramite" (change)="limpiarRespuesta()" name="nroTramite"
                                   label="Número de Trámite del DNI" [required]="true">
                        </plex-text>
                        <plex-select [(ngModel)]="ciudadano.sexo" label="Seleccione sexo" [data]="sexos" name="sexo"
                                 required="true" placeholder="Seleccione..">
                        </plex-select>
                        <plex-datetime label="Fecha de Nacimiento" type="date" [(ngModel)]="ciudadano.fechaNacimiento" 
                            name="fechaNacimiento" placeholder="dd/mm/yyyy">
                        </plex-datetime>
                        <plex-text [(ngModel)]="ciudadano.apellido" (change)="limpiarRespuesta()" name="apellido"
                                    label="Apellido" [required]="true">
                        </plex-text>
                        <plex-text [(ngModel)]="ciudadano.nombre" (change)="limpiarRespuesta()" name="nombre"
                                    label="Nombre" [required]="true" grow="4">
                        </plex-text>
                        
                        <plex-select name="localidades" [data]="localidades$ | async" label="Localidad" [(ngModel)]="ciudadano.localidad">
                        </plex-select>
                        <plex-phone label="Teléfono" [(ngModel)]="ciudadano.telefono" name="telefono" [required]="true"
                                    placeholder="Ej: 2990000000">
                        </plex-phone>
                    </plex-grid>
                    <ng-container>
                        <br>
                        <plex-label titulo="Marcar todas las que correspondan" size="lg"></plex-label>
                        <plex-bool type="checkbox" name="alergia" [(ngModel)]="ciudadano.alergia" label="Alguna vez he tenido una reacción alérgica GRAVE (que requirió internación o puso mi vida en peligro) con una vacuna o medicamento"></plex-bool>
                        <plex-bool type="checkbox" name="condicion" [(ngModel)]="ciudadano.condicion" label="Tengo una enfermedad / condición que compromete GRAVEMENTE mis defensas"></plex-bool>
                        <plex-bool type="checkbox" name="enfermedad" [(ngModel)]="ciudadano.enfermedad" label="Estoy cursando una enfermedad / complicación aguda (clínica o quirúrgica) que me debilita"></plex-bool>
                        <plex-bool type="checkbox" name="convaleciente" [(ngModel)]="ciudadano.convaleciente" label="Estoy todavía debilitado y recuperándome de una enfermedad / complicación aguda (convaleciente)"></plex-bool>
                        <plex-bool type="checkbox" name="aislamento" [(ngModel)]="ciudadano.aislamento" label="Estoy esperando el alta de aislamiento por tener COVID confirmado o por haber sido contacto estrecho de un caso COVID"></plex-bool>
                        <plex-bool type="checkbox" name="vacuna" [(ngModel)]="ciudadano.vacuna" label="He recibido otra vacuna hace MENOS de 4 semanas"></plex-bool>
                        <plex-bool type="checkbox" name="plasma" [(ngModel)]="ciudadano.plasma" label="He recibido plasma / suero hiperinmune / inmunoglobulinas / anticuerpos monoclonales hace menos de 3 meses"></plex-bool>
                        <plex-bool type="checkbox" name="mamar" [(ngModel)]="ciudadano.mamar" label="Estoy dando de mamar"></plex-bool>
                        <plex-bool type="checkbox" name="embarazada" [(ngModel)]="ciudadano.embarazada" label="Estoy embarazada / Sospecho que podría estar embarazada"></plex-bool>
                    </ng-container>
                    <ng-container *ngIf="ciudadano.grupo && ciudadano.grupo.id === 'personal-salud'">
                        <br>
                        <plex-label titulo="Datos Laborales" size="lg"></plex-label>
                        <plex-text [(ngModel)]="ciudadano.establecimiento" (change)="limpiarRespuesta()" name="establecimiento"
                                   label="Establecimiento donde cumple la mayor carga horaria" [required]="true">
                        </plex-text>
                        <plex-select name="localidades" [data]="localidades$ | async" label="Localidad del establecimiento" [(ngModel)]="ciudadano.localidadEstablecimiento" [required]="true">
                        </plex-select>
                        <plex-radio [(ngModel)]="ciudadano.relacion" [data]="relacionLaboral" name="relacion">
                        </plex-radio>
                        <plex-label titulo="Funciones / tareas que realiza" size="lg"></plex-label>
                        <plex-select name="profesiones" [data]="profesiones$ | async" label="Solo para matriculados: Tipo de matrícula" [(ngModel)]="ciudadano.profesion">
                        </plex-select>
                        <plex-int name="numeroMatricula" [(ngModel)]="ciudadano.numeroMatricula" label="Número de Matricula">

                        </plex-int>
                    </ng-container>
                    <div class="form-group mt-2">
                        <re-captcha (resolved)="resolved($event)" siteKey="6Lc5nUsaAAAAALJ15OtJMKpdW9XSEOl13A_3Hx6i">
                        </re-captcha>
                    </div>
                </form>
            </div>
        </div>
    </plex-layout-main>
</plex-layout>